<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Prototy Demo</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      .counter {
        font-size: 24px;
        margin: 20px 0;
        padding: 10px;
        border: 1px solid #ccc;
        display: inline-block;
      }
      button {
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 4px;
      }
      button:hover {
        background-color: #0056b3;
      }
      .hidden {
        display: none !important;
      }
    </style>
  </head>
  <body>
    <h1>Prototy Demo</h1>

    <!-- Первый счетчик -->
    <div class="counter">
      Сумма: <span :text="state.value + state.product.count"></span>
    </div>

    <!-- Второй счетчик -->
    <div class="counter">
      Product count: <span :text="state.product.count"></span>
    </div>

    <!-- Кнопка для увеличения счетчика -->
    <button :onclick="() => { state.product.count++ }">
      Увеличить product.count
    </button>

    <!-- Кнопка для увеличения value -->
    <button :onclick="() => { state.value++ }">Увеличить value</button>

    <!-- Переключатель видимости -->
    <button :onclick="() => { state.hidden = !state.hidden }">
      <span :text="state.hidden ? 'Показать' : 'Скрыть'"></span> скрытый элемент
    </button>

    <!-- Скрытый элемент -->
    <div
      :hidden="state.hidden"
      style="margin-top: 20px; padding: 10px; background-color: #f0f0f0"
    >
      Этот элемент скрыт когда state.hidden = true
    </div>

    <!-- Автоматическое обновление -->
    <div style="margin-top: 20px">
      <button :onclick="state._handles.startAutoIncrement">
        Автоинкремент (интервал)
      </button>
      <button :onclick="state._handles.stopAutoIncrement">Остановить</button>
    </div>

    <script type="module">
      import Prototy from "../src/prototy.js";

      let intervalId = null;

      const prototy = new Prototy({
        state: {
          hidden: true,
          value: 1,
          product: {
            count: 1,
          },
        },
        handles: {
          startAutoIncrement() {
            if (intervalId) clearInterval(intervalId);
            intervalId = setInterval(() => {
              this.state.product.count++;
            }, 1000);
          },
          stopAutoIncrement() {
            if (intervalId) {
              clearInterval(intervalId);
              intervalId = null;
            }
          },
        },
      });

      // Экспортируем для отладки
      window.prototy = prototy;
    </script>
  </body>
</html>
